## github 페이지와 리포지토리

-   [깃 허브 페이지의 공식문서](https://docs.github.com/ko/pages)를 보자.

### 리포지토리란?

> 리포지토리는 일반적으로 단일 프로젝트를 구성하는 데 사용됩니다. 리포지토리에는 프로젝트에 필요한 모든 폴더와 파일, 이미지, 비디오, 스프레드시트 및 데이터 세트가 포함될 수 있습니다. 리포지토리에 README 파일, 프로젝트에 대한 정보가 포함된 파일이 있는 경우도 많습니다. <sup>[link](https://docs.github.com/ko/get-started/quickstart/hello-world#creating-a-repository)</sup>

### github 페이지의 리포지토리 크기

> 리포지토리는 작게 유지되고 이상적으로는 1GB 미만이며 5GB 미만을 사용하는 것이 좋습니다.
> 리포지토리가 인프라에 지나치게 영향을 주는 경우 GitHub 지원에서 정정 작업을 수행하라는 메일을 받을 수 있습니다.

-   깃허브에 직접 작성한 코드만 올리는 것으로는 리포지토리를 아무리 사용해도 1GB 이상 사용하기 힘들다.
-   하지만 라이브러리, 이미지, 폰트, PDF와 같은 파일은 용량이 크기 때문에 이러한 파일을 반복적으로 git으로 추가하고 변경하고 삭제하다보면 금새 리포지토리의 용량은 1GB가 된다.

#### 라이브러리의 관리

-   자바스크립트의 경우 라이브러리는 `node_modules` 폴더에 저장이 된다. 라이브러리는 용량이 상당히 큰데 라이브러리 리스트는 `package.json`, `package-lock.json`에 기록이 되기 때문에 라이브러리 폴더는 깃으로 추적하지 않고 라이브러리 리스트 파일만 깃으로 추적하도록 한다.
-   라이브러리 폴더가 깃으로 추적되지 않으므로 깃 허브와 같은 원격 리포지토리에 올릴 때 라이브러리 파일의 용량을 줄일 수 있다.
-   깃으로 프로젝트를 다운로드 받았을 때 라이브러리 파일은 없고 라이브러리 리스트 파일만 존재한다. 이 리스트 파일로 별도로 라이브러리를 설치하여 프로젝트에서 의존하는 라이브러리를 설치한다.

#### 파일 및 이미지 관리

-   프론트앤드 디자인을 하다보면 파일이나 이미지 파일을 깃 허브에 올릴 수 밖에 없는 경우가 생긴다.
-   대표적으로 깃허브 페이지를 이용한 정적 사이트(NodeJS나 php나 ruby 등의 백앤드 시스템과 상호작용이 없는)를 만들 때 요구사항이나 디자인의 변경에 따라 파일 및 이미지를 여러 번 변경하게 될 수 있다.
-   이 때 파일 및 이미지의 변경 기록을 깃으로 추적하게 되면, 새로운 이미지가 추가 될 때마다 깃의 기록에 이미지 파일이 남게 되어 깃 기록의 용량이 커지게 된다. 깃 기록의 용량이 커지게 되면 이 기록을 저장하는 원격 저장소인 리포지토리의 용량도 커지게 된다.
-   따라서 용량이 큰 파일 및 이미지는 최종적으로 결정된 사안만 깃으로 추적하도록 설정하는 것이 좋다. 또는 프로젝트 폴더에 저장하지 않고 외부 서버에 저장하여 외부 서버의 파일 및 이미지를 방법을 쓸 수도 있다.
-   서버 프로그래밍과 파일을 저장하는 용도의 클라우드의 파일 저장 시스템(ex: AWS S3)을 이용할 수 있다면, 이미지 파일을 클라우드의 파일 저장 시스템에서 이미지 파일을 가져오는 방식으로 만들어 프로젝트 폴더에서 이미지 파일을 가져오지 않도록 만들 수도 있다.
-   또 다른 방안으로는 다운로드할 파일은 압축을 해서 저장을 하고, 이미지는 고화질의 해상도가 불필요하다면 해상도를 낮추어 용량을 최대한 줄여 사용하는 방법이 필요하다.

### 깃 기록에서 파일 삭제하기

-   파일이나 이미지의 추가, 변경, 삭제 기록이 늘어나면 늘어날 수록 깃은 추가, 변경, 삭제 된 모든 파일이나 이미지를 기록하고 있다. 그래서 과거의 기록으로 되돌아갈 수 있는 기능을 제공하는 것이 깃의 역할이다.
-   하지만 모든 기록을 다 가지고 있기 때문에 커밋 기록이 쌓여갈 수록 용량이 점점 늘어나는 단점이 있다. 일반 코드의 경우에는 용량이 작아서 별 문제가 되지 않지만, 이미지나 파일의 경우 용량이 크기 때문에 빠르게 깃 히스토리의 용량을 증가시키고, 이로 인해 깃 허브 리포지토리의 용량도 빠르게 잡아먹는다.
-   따라서 깃 히스토리에 기록되어 있는 더 이상 사용하지 않는 파일이나 이미지를 삭제하는 방법을 사용할 필요가 있을 때가 있다. 깃 히스토리에서 파일을 삭제하는 방법은 다음 [링크](https://docs.github.com/ko/repositories/working-with-files/managing-large-files/about-large-files-on-github#removing-files-from-a-repositorys-history)를 참고 하도록 하자.
-   하지만 이러한 방법은 깃을 많이 다루지 못한 사람들에게는 실수를 유발하거나 어려울 수 있기 때문에 추천하지 않는 방법이다.

### 웹팩으로 빌드된 폴더 올리기

-   기본적으로 웹팩을 사용할 때 개발하는 코드들은 src 폴더에 위치한다. 웹 사이트로 서버에 배포하기 위해서는 빌드를 해야 한다. 웹팩에서 빌드를 하면 `dist` 폴더에 여러 웹팩 옵션이 적용된 코드와 파일이 위치하게 된다.
-   프로젝트에서 필요한 모든 코드가 git으로 관리되고 있기 때문에 어떤 시점에서 빌드된 파일을 따로 저장하지 않아도 이전 기록으로 되돌아가서 빌드를 하면 빌드된 파일이 나오기 때문에 깃으로 굳이 빌드된 파일을 기록할 필요는 없다. 따라서 빌드된 폴더는 깃으로 추적할 필요가 없다.
-   또한 빌드가 되면 파일이나 이미지가 빌드된 폴더에 복사 되거나 웹팩에 의해 변환 된 결과물이 생성된다. 이 코드에느 라이브러리의 코드, 이미지, 파일 등을 개발할 때 사용한 이미지, 파일, 라이브러리를 복사해 버리기 때문에 빌드된 결과를 깃으로 추적할 경우 깃허브에 올라가는 파일의 용량이 대략 2배가 되어 버린다.
-   하지만 빌드된 결과를 공유해야 할 때가 있다. 빌드된 결과를 깃허브 페이지에 적용할 때나 중간 결과물을 개발자가 아닌 사람이 확인할 때이다. 개발자라면 빌드하는 것이 간단하겠지만 개발자가 아니라면 깃 허브에 올려서 파일을 공유하여 빌드에 필요한 준비 없이 간단하게 결과물을 확인할 수 있도록 빌드된 결과물을 깃허브에 올리는 방식을 쓰는 편이 좋다.
-   하지만 빌드된 결과물을 올리면 리포지토리의 용량이 늘어난다. 추후 리포지토리의 용량을 줄이기 위해서 빌드된 결과물의 히스토리를 삭제할 필요성도 생기는데 [리포지토리의 기록에서 원치 않는 파일을 완전히 제거](https://docs.github.com/ko/authentication/keeping-your-account-and-data-secure/removing-sensitive-data-from-a-repository)를 보면 삭제할 때 실수를 하게 되면 꽤나 복잡한 설정을 해야하므로 권장하기 어려운 방법을 쓰고 있다.
-   빌드된 파일을 깃 허브와 같은 원격 저장소에 올리면서도 쉽게 삭제를 하는 방법은 새로운 브렌치를 만들어서 빌드된 파일을 올리는 것이다. 빌드된 파일이 올라간 브렌치를 빌드하기 전의 코드를 관리하는 브렌치로 머지하지 않는다면 빌드된 파일이 올라간 브렌치를 삭제하는 방식을 이용하여 효과적으로 빌드 결과물을 공유한 이후 삭제할 수 있는 방법을 쓸 수 있다.
-   더 나은 방법은 빈 브렌치를 하나 만들고 빌드 파일이 생성되는 폴더만 빈 브렌치에 올리는 방식이 있다.

### 빌드된 결과물을 빈 브렌치에 올리기

1. 빌드하기

    ```sh
    yarn run build
    ```

    - 위 명령어를 실행하여 `dist` 폴더에 빌드한 결과물을 만든다.

2. 빌드 폴더의 이름을 `docs`로 변경하기

    - `dist` 폴더의 이름을 `docs`으로 만든다.

3. 빈 브렌치 만들기

    - 비어있는 새로운 브렌치를 만드는 명령은 `git switch --orphan 새로운_비어있는_브렌치명`이다. 비어있는 브렌치를 만들도록 하자.
    - 이 명령어를 사용할 때 요구사항이 있는데 깃에 의해 추적되고 있는 파일은 커밋되지 않은 파일이 없이 모두 커밋 되어야 한다는 점이다. (이 과정을 진행할 때는 `git stash` 등의 명령어를 사용하여 `hanges not staged for commit:`에 해당하는 임시 저장하도록 하자. 아래의 작업 진행 후 다시 원래 브렌치로 돌아와서 `git stash apply` 명령을 실행하면 임시 저장된 대상이 복구되면서 `hanges not staged for commit:`에 변경 사항을 가진 파일들이 표시되게 된다.)

    ```sh
    git switch --orphan gh-pages
    ```

4. 빈 브렌치에 `docs` 폴더 넣기

    ```sh
    git add docs
    ```

    - `docs`라는 명칭의 폴더는 github에서 github 페이지로 배포할 수 있도록 허용된 폴더명이다. `docs`를 사용하지 않는다면 프로젝트 루트 페이지를 공유하게 된다.

    ```sh
    git commit -m "빌드된 파일 업로드"
    ```

5. 원격 저장소로 푸시하기

    ```sh
    git push origin gh-pages
    ```
